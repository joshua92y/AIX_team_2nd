{% extends 'base.html' %}
{% load static %}

{% block title %}상권 분석{% endblock %}

{% block content %}
  {% include 'includes/header.html' %}

  <!-- Page Title -->
  <div class="container my-6" style="margin-top: 120px; margin-bottom: 100px; ">
    
    <!-- 상권 분석 정보 입력 -->
    <div class="row">
      <div class="col-lg-12 mb-4">
        <div class="card p-4 shadow-sm">
          <h3 class="mb-3">상권 분석 정보입력</h3>
          <form>
            <div class="row g-3">
              <div class="col-md-4">
                <label for="area" class="form-label">점포 면적 (㎡)</label>
                <input type="number" class="form-control" id="area" placeholder="예: 33.2">
              </div>
              <div class="col-md-4">
                <label for="total_lv" class="form-label">총 지가 (₩)</label>
                <input type="number" class="form-control" id="total_lv" placeholder="예: 180000000">
              </div>
              <div class="col-md-4">
                <label for="service" class="form-label">주류 판매 여부</label>
                <select class="form-select" id="service">
                  <option selected disabled>선택</option>
                  <option value="1">판매함</option>
                  <option value="0">판매 안함</option>
                </select>
              </div>
            </div>
            <div class="text-center mt-4">
              <button type="button" class="btn btn-primary px-5" disabled>상권 분석하기</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- 본문: 분석 결과 + 챗봇 -->
    <div class="row">
      <!-- 왼쪽: 분석 리포트 -->
      <div class="col-lg-8 mb-4">
        <div class="card p-4 shadow-sm">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h4 class="mb-0">상권 분석 결과</h4>
            <!-- 모달 버튼 -->
            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#explanationModal">
              상권 분석 도움말
            </button>
            
            <!-- Bootstrap 모달 -->
            <div class="modal fade" id="explanationModal" tabindex="-1" aria-labelledby="explanationModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="explanationModalLabel">상권 분석이란 무엇인가?</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
                  </div>
                  <div class="modal-body">
                    상권분석은 특정 지역 내 점포나 사업장의 경제적 환경과 소비자 특성을 체계적으로 조사하여<br>
                    사업 성공 가능성을 높이기 위한 중요한 과정입니다.<br><br>
            
                    <strong>왜 상권분석이 필요한가요?</strong><br>
                    - 상권의 소비 패턴과 유동 인구를 파악하여 효율적인 마케팅 전략을 세울 수 있습니다.<br>
                    - 경쟁 업체 현황과 고객 수요를 분석해 적절한 입지와 서비스를 결정할 수 있습니다.<br>
                    - 투자 위험을 최소화하고 안정적인 매출을 기대할 수 있습니다.<br><br>
            
                    <strong>AI 기반 상권분석은 다음을 제공합니다:</strong><br>
                    - 점포의 생존 확률 예측<br>
                    - SHAP 요인 분석<br><br>
            
                    성공적인 창업과 운영을 위해<br>
                    정확한 정보를 바탕으로 전략을 세워보세요!
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <p class="text-muted">* 분석 결과는 이곳에 표시됩니다.</p>
          <button class="btn btn-primary mt-3" disabled>PDF로 저장</button>
        </div>
      </div>

      <!-- 오른쪽: 챗봇 -->
      <div class="col-lg-4">
        <div class="card p-4 shadow-sm">
          <h5>분석 결과 챗봇</h5>

          <!-- 예시 질문 버튼 -->
          <div style="margin-bottom: 10px;">
            <span class="text-muted">추천 질문</span><br>
            <button class="btn btn-sm btn-outline-secondary me-1 mt-1" onclick="fillExampleQuestion('이 상권의 유동 인구 특징은 어떤가요?')">유동 인구</button>
            <button class="btn btn-sm btn-outline-secondary me-1 mt-1" onclick="fillExampleQuestion('이 지역의 경쟁 업체 수는 얼마나 되나요?')">경쟁 업체</button>
            <button class="btn btn-sm btn-outline-secondary me-1 mt-1" onclick="fillExampleQuestion('이 지역은 창업 위험이 높은 편인가요?')">창업 위험</button>
            <button class="btn btn-sm btn-outline-secondary me-1 mt-1" onclick="fillExampleQuestion('주변 상권 중 가장 활발한 업종은 무엇인가요?')">인기 업종</button>
          </div>

          <!-- 질문 출력 영역 -->
          <div class="border rounded p-2 mb-2" style="height: 250px; overflow-y: auto;">
            <p class="text-muted">여기에 질문/응답이 출력됩니다.</p>
          </div>

          <!-- 질문 입력 및 전송 -->
          <input type="text" class="form-control mb-2" id="chatInput" placeholder="질문을 입력하세요">
          <button type="button" class="btn btn-outline-primary w-100">보내기</button>
        </div>
      </div>
    </div>
  </div>
  <script>
    function fillExampleQuestion(text) {
      document.getElementById('chatInput').value = text;
    }
  </script>
{% endblock %}
