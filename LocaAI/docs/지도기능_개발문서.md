# ì„œìš¸ì‹œ ìƒê¶Œë¶„ì„ ì§€ë„ ê¸°ëŠ¥ ê°œë°œ ë¬¸ì„œ

## ğŸ“‹ ê°œìš”

ì„œìš¸ì‹œ 25ê°œ êµ¬ë³„ ë° í–‰ì •ë™ë³„ ìƒê¶Œ ì •ë³´ë¥¼ ì‹œê°í™”í•˜ëŠ” ì¸í„°ë™í‹°ë¸Œ ì§€ë„ ê¸°ëŠ¥ì…ë‹ˆë‹¤. OpenLayersë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„ë˜ì—ˆìœ¼ë©°, êµ¬ë³„ ì •ë³´ í‘œì‹œ, í–‰ì •ë™ ë“œë¦´ë‹¤ìš´, ì—…ì²´ ìˆ˜ ì§‘ê³„ ë“±ì˜ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### 1. êµ¬ë³„ ì§€ë„ í‘œì‹œ
- ì„œìš¸ì‹œ 25ê°œ êµ¬ì˜ ê²½ê³„ë©´ í‘œì‹œ
- ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ êµ¬ë³„ ì •ë³´ íŒì—… (ì—…ì²´ ìˆ˜)
- êµ¬ í´ë¦­ ì‹œ í•´ë‹¹ êµ¬ì˜ í–‰ì •ë™ìœ¼ë¡œ ë“œë¦´ë‹¤ìš´

### 2. í–‰ì •ë™ ë“œë¦´ë‹¤ìš´
- êµ¬ í´ë¦­ ì‹œ í•´ë‹¹ êµ¬ì˜ í–‰ì •ë™ë“¤ì„ ìƒì„¸ í‘œì‹œ
- í–‰ì •ë™ë³„ ìƒì„¸ ì •ë³´ (ê±°ì£¼ì¸êµ¬, ì§ì¥ì¸êµ¬, ì—…ì²´ìˆ˜, ì£¼ìš”ì—…ì¢…)
- í‰ê·  ìƒì¡´ë¥  ë° ê°€ì¥ ë§ì€ ì—…ì¢… ì •ë³´ ì œê³µ

### 3. ìŠ¤ë§ˆíŠ¸ íŒì—…
- í™”ë©´ ìœ„ì¹˜ì— ë”°ë¥¸ ìë™ íŒì—… ìœ„ì¹˜ ì¡°ì •
- ìƒë‹¨ 30% ì˜ì—­ì—ì„œëŠ” ë§ˆìš°ìŠ¤ ì•„ë˜ìª½ì— í‘œì‹œ
- í•˜ë‹¨ ì˜ì—­ì—ì„œëŠ” ë§ˆìš°ìŠ¤ ìœ„ìª½ì— í‘œì‹œ

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### Frontend
- **OpenLayers 9.2.4**: ì›¹ ì§€ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **Proj4js 2.9.2**: ì¢Œí‘œê³„ ë³€í™˜
- **JavaScript ES6+**: ëª¨ë˜ JavaScript ë¬¸ë²•
- **CSS3**: ìŠ¤íƒ€ì¼ë§ ë° ì• ë‹ˆë©”ì´ì…˜

### Backend
- **Django**: ì›¹ í”„ë ˆì„ì›Œí¬
- **PostGIS**: ê³µê°„ ë°ì´í„°ë² ì´ìŠ¤
- **GeoDjango**: Djangoì˜ ì§€ë¦¬ì •ë³´ í™•ì¥

### ì¢Œí‘œê³„
- **EPSG:5186**: í•œêµ­ ì¤‘ë¶€ì›ì  TM ì¢Œí‘œê³„ (ì›ë³¸ ë°ì´í„°)
- **EPSG:3857**: Web Mercator (ì§€ë„ í‘œì‹œìš©)

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
LocaAI/
â”œâ”€â”€ shopdash/
â”‚   â”œâ”€â”€ views.py                    # ì§€ë„ API ì—”ë“œí¬ì¸íŠ¸
â”‚   â”œâ”€â”€ urls.py                     # URL íŒ¨í„´
â”‚   â””â”€â”€ templates/shopdash/
â”‚       â””â”€â”€ dashboard.html          # ì§€ë„ ì»¨í…Œì´ë„ˆ í¬í•¨ í…œí”Œë¦¿
â”œâ”€â”€ static/js/
â”‚   â””â”€â”€ shopdash_map.js            # ì§€ë„ JavaScript êµ¬í˜„
â”œâ”€â”€ GeoDB/
â”‚   â”œâ”€â”€ models.py                   # SeoulDistrict, AdministrativeDistrict ëª¨ë¸
â”‚   â”œâ”€â”€ admin.py                    # ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ 0005_seouldistrict.py  # SeoulDistrict í…Œì´ë¸” ìƒì„±
â”‚   â””â”€â”€ management/commands/
â”‚       â”œâ”€â”€ import_seoul_districts.py  # êµ¬ë³„ ë°ì´í„° ì„í¬íŠ¸
â”‚       â””â”€â”€ import_dong_store.py       # ìƒì  ë°ì´í„° ì„í¬íŠ¸
â””â”€â”€ docs/
    â””â”€â”€ ì§€ë„ê¸°ëŠ¥_ê°œë°œë¬¸ì„œ.md       # ì´ ë¬¸ì„œ
```

## ğŸ—„ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### 1. seoul_district í…Œì´ë¸”
```sql
CREATE TABLE seoul_district (
    id SERIAL PRIMARY KEY,
    adm_sect_c VARCHAR(10) UNIQUE,     -- í–‰ì •êµ¬ì—­ì½”ë“œ (11110: ì¢…ë¡œêµ¬)
    sgg_nm VARCHAR(100),               -- êµ¬ëª… (ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬)
    sgg_oid FLOAT,                     -- êµ¬ OID
    col_adm_se VARCHAR(10),            -- í–‰ì •êµ¬ë¶„
    geom GEOMETRY(MULTIPOLYGON, 5186), -- êµ¬ê²½ê³„ë©´
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

### 2. í–‰ì •ë™êµ¬ì—­ í…Œì´ë¸”
```sql
CREATE TABLE "í–‰ì •ë™êµ¬ì—­" (
    fid SERIAL PRIMARY KEY,
    emd_cd VARCHAR(8),                 -- í–‰ì •ë™ì½”ë“œ (8ìë¦¬)
    emd_eng_nm VARCHAR(100),           -- ì˜ë¬¸í–‰ì •ë™ëª…
    emd_kor_nm VARCHAR(100),           -- í•œê¸€í–‰ì •ë™ëª…
    geom GEOMETRY(MULTIPOLYGON, 5186)  -- í–‰ì •êµ¬ì—­ê²½ê³„
);
```

### 3. dong_store í…Œì´ë¸”
```sql
CREATE TABLE dong_store (
    id SERIAL PRIMARY KEY,
    emd_kor_nm VARCHAR(100),           -- í–‰ì •ë™ëª…
    uptaenm VARCHAR(100),              -- ì—…ì¢…ëª… (ëŒ€ë¬¸ì)
    -- ê¸°íƒ€ ìƒì  ì •ë³´ í•„ë“œë“¤
);
```

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸

### 1. êµ¬ë³„ GeoJSON API
```
GET /shopdash/api/seoul-districts/
```
**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
    "type": "FeatureCollection",
    "features": [
        {
            "type": "Feature",
            "properties": {
                "adm_sect_c": "11110",
                "sgg_nm": "ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬",
                "district_name": "ì¢…ë¡œêµ¬",
                "business_count": 2910
            },
            "geometry": {
                "type": "MultiPolygon",
                "coordinates": [...]
            }
        }
    ]
}
```

### 2. í–‰ì •ë™ GeoJSON API
```
GET /shopdash/api/dong-geojson/?gu_code=11680
```
**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
    "type": "FeatureCollection", 
    "features": [
        {
            "type": "Feature",
            "properties": {
                "emd_cd": "11680101",
                "emd_kor_nm": "ì‹ ì‚¬ë™",
                "dong_life": 45230,
                "dong_work": 31661,
                "total_businesses": 1247,
                "avg_survival_rate": 73.2,
                "top_business_type": "ìŒì‹ì ",
                "top_business_count": 324
            },
            "geometry": {
                "type": "MultiPolygon",
                "coordinates": [...]
            }
        }
    ]
}
```

## ğŸ’» ì£¼ìš” í´ë˜ìŠ¤ ë° ë©”ì„œë“œ

### SeoulCommercialMap í´ë˜ìŠ¤

```javascript
class SeoulCommercialMap {
    constructor(containerId)           // ì§€ë„ ì´ˆê¸°í™”
    setupProjections()                 // ì¢Œí‘œê³„ ì„¤ì •
    createMap()                        // OpenLayers ì§€ë„ ìƒì„±
    createPopup()                      // íŒì—… ì˜¤ë²„ë ˆì´ ìƒì„±
    loadDistrictLayer()                // êµ¬ë³„ ë ˆì´ì–´ ë¡œë“œ
    setupSelection()                   // ì„ íƒ ì´ë²¤íŠ¸ ì„¤ì •
    handleDistrictHover(event)         // êµ¬ë³„ ë§ˆìš°ìŠ¤ì˜¤ë²„ ì²˜ë¦¬
    handleDongHover(event)             // í–‰ì •ë™ ë§ˆìš°ìŠ¤ì˜¤ë²„ ì²˜ë¦¬
    showPopup(coordinate, properties)  // êµ¬ë³„ íŒì—… í‘œì‹œ
    showDongPopup(coordinate, properties) // í–‰ì •ë™ íŒì—… í‘œì‹œ
    setSmartPopupPosition(coordinate)  // ìŠ¤ë§ˆíŠ¸ íŒì—… ìœ„ì¹˜ ì„¤ì •
    zoomToDistrict(feature, guCode)    // êµ¬ í™•ëŒ€ ë° í–‰ì •ë™ í‘œì‹œ
    loadDongLayer(guCode)              // í–‰ì •ë™ ë ˆì´ì–´ ë¡œë“œ
    returnToDistrictView()             // êµ¬ë³„ ë·°ë¡œ ë³µê·€
}
```

## ğŸ¨ ìŠ¤íƒ€ì¼ë§

### êµ¬ë³„ ë ˆì´ì–´ ìŠ¤íƒ€ì¼
```javascript
new ol.style.Style({
    stroke: new ol.style.Stroke({
        color: '#4154f1',
        width: 2
    }),
    fill: new ol.style.Fill({
        color: 'rgba(65, 84, 241, 0.1)'
    })
})
```

### í–‰ì •ë™ ë ˆì´ì–´ ìŠ¤íƒ€ì¼
```javascript
new ol.style.Style({
    stroke: new ol.style.Stroke({
        color: '#2196F3',
        width: 2
    }),
    fill: new ol.style.Fill({
        color: 'rgba(33, 150, 243, 0.1)'
    })
})
```

### íŒì—… CSS
```css
.ol-popup {
    position: absolute;
    background-color: white;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    padding: 15px 20px;
    border-radius: 12px;
    border: none;
    min-width: 200px;
    max-width: 300px;
    font-family: 'Nunito', sans-serif;
}

.ol-popup[data-position="bottom"]:after {
    border-top-color: white;
    border-bottom: none;
}

.ol-popup[data-position="top"]:after {
    border-bottom-color: white;
    border-top: none;
}
```

## ğŸ”§ ì„¤ì • ë° ì„¤ì¹˜

### 1. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
```html
<!-- OpenLayers -->
<script src="https://cdn.jsdelivr.net/npm/ol@9.2.4/dist/ol.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@9.2.4/ol.css">

<!-- Proj4js -->
<script src="https://cdn.jsdelivr.net/npm/proj4@2.9.2/dist/proj4.js"></script>
```

### 2. Django ì„¤ì •
```python
# settings.py
INSTALLED_APPS = [
    'django.contrib.gis',
    'GeoDB',
    'shopdash',
]

DATABASES = {
    'default': {
        'ENGINE': 'django.contrib.gis.db.backends.postgis',
        # ê¸°íƒ€ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
    }
}
```

### 3. URL ì„¤ì •
```python
# shopdash/urls.py
urlpatterns = [
    path('api/seoul-districts/', views.get_seoul_districts_geojson, name='seoul_districts_geojson'),
    path('api/dong-geojson/', views.get_dong_geojson, name='dong_geojson'),
]
```

## ğŸ“Š ë°ì´í„° ì§‘ê³„ ì¿¼ë¦¬

### êµ¬ë³„ ì—…ì²´ ìˆ˜ ì§‘ê³„
```sql
SELECT COUNT(*) FROM dong_store ds
JOIN "í–‰ì •ë™êµ¬ì—­" ad ON ds.emd_kor_nm = ad.emd_kor_nm
WHERE ad.emd_cd LIKE '11680%'  -- ê°•ë‚¨êµ¬ ì˜ˆì‹œ
```

### í–‰ì •ë™ë³„ ì£¼ìš” ì—…ì¢… ì§‘ê³„
```sql
SELECT 
    ds.UPTAENM, 
    COUNT(*) as count
FROM dong_store ds
JOIN "í–‰ì •ë™êµ¬ì—­" ad ON ds.emd_kor_nm = ad.emd_kor_nm
WHERE ad.emd_cd = '11680101'  -- ì‹ ì‚¬ë™ ì˜ˆì‹œ
GROUP BY ds.UPTAENM
ORDER BY count DESC
LIMIT 1
```

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. SeoulDistrict ëª¨ë¸ import ì˜¤ë¥˜
**ë¬¸ì œ**: `cannot import name 'SeoulDistrict' from 'GeoDB.models'`
**í•´ê²°**: `python manage.py migrate` ì‹¤í–‰í•˜ì—¬ migration ì ìš©

### 2. ì¢Œí‘œê³„ ë³€í™˜ ì˜¤ë¥˜
**ë¬¸ì œ**: ì§€ë„ì— ë°ì´í„°ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ
**í•´ê²°**: EPSG:5186 ì¢Œí‘œê³„ ì •ì˜ í™•ì¸ ë° proj4 ì„¤ì •

### 3. íŒì—… ìœ„ì¹˜ ë¬¸ì œ
**ë¬¸ì œ**: íŒì—…ì´ í™”ë©´ ìƒë‹¨ì—ì„œ ì§€ë„ë¥¼ ì´ë™ì‹œí‚´
**í•´ê²°**: `setSmartPopupPosition()` ë©”ì„œë“œë¡œ ë™ì  ìœ„ì¹˜ ì¡°ì •

### 4. ì°¨íŠ¸ ë°ì´í„° ì˜¤ë¥˜
**ë¬¸ì œ**: `Cannot read properties of undefined (reading '0')`
**í•´ê²°**: JavaScriptì—ì„œ ì•ˆì „í•œ ë°ì´í„° ì ‘ê·¼ì„ ìœ„í•œ null ì²´í¬ ì¶”ê°€

## ğŸš€ í–¥í›„ ê°œì„  ì‚¬í•­

### 1. ì„±ëŠ¥ ìµœì í™”
- ë²¡í„° íƒ€ì¼ ì„œë¹„ìŠ¤ ë„ì…
- ë ˆì´ì–´ ìºì‹± êµ¬í˜„
- ë°ì´í„° ì••ì¶• ìµœì í™”

### 2. ê¸°ëŠ¥ í™•ì¥
- ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€
- í•„í„°ë§ ì˜µì…˜ ì œê³µ
- íˆíŠ¸ë§µ ì‹œê°í™”

### 3. ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- ë¡œë”© ì¸ë””ì¼€ì´í„° ê°œì„ 
- í„°ì¹˜ ì œìŠ¤ì²˜ ì§€ì›
- ë°˜ì‘í˜• ë””ìì¸ ê°•í™”

## ğŸ“ ì°¸ê³  ìë£Œ

- [OpenLayers Documentation](https://openlayers.org/en/latest/doc/)
- [Proj4js Documentation](http://proj4js.org/)
- [GeoDjango Documentation](https://docs.djangoproject.com/en/stable/ref/contrib/gis/)
- [PostGIS Documentation](https://postgis.net/documentation/)

---

**ì‘ì„±ì¼**: 2025ë…„ 6ì›” 20ì¼  
**ì‘ì„±ì**: SSH íŒ€  
**ë²„ì „**: 1.0.0 